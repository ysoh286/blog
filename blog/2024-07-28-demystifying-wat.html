<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link
			rel="stylesheet"
			href="https://fonts.googleapis.com/css?family=DM+Sans:bold,regular|DM+Serif+Display"
		/>
		<link rel="icon" href="/favicon.png" />
		<meta name="viewport" content="width=device-width" />
		<meta http-equiv="content-security-policy" content="">
		<link href="../_app/immutable/assets/_layout-373efd3e.css" rel="stylesheet">
		<link href="../_app/immutable/assets/_page-7ec42711.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/start-d30e0694.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index-794e8e40.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/singletons-d3d33929.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper-41c905a7.js">
		<link rel="modulepreload" href="../_app/immutable/components/pages/_layout.svelte-9b5f918a.js">
		<link rel="modulepreload" href="../_app/immutable/modules/pages/_layout.js-9cbb603b.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/_layout-da46b06b.js">
		<link rel="modulepreload" href="../_app/immutable/components/pages/blog/_slug_/_page.svelte-b42c409e.js">
		<link rel="modulepreload" href="../_app/immutable/modules/pages/blog/_slug_/_page.ts-789566a4.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/_page-23d239ff.js">
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">






<header class="svelte-1n1kweh"><h1 class="svelte-1n1kweh">Blog - docs, notes, weird discoveries and ramblings all in one place.</h1></header>


<main>


<article class="svelte-med8i0"><h1>i still don't know js: demystifying the 2012 wat video</h1>
	<p>28 July, 2024</p>
	<div class="line-break svelte-med8i0"></div>
	
	<div class="post-content svelte-med8i0"><p>For software engineers, you’ve most likely come across the popular <a href="https://www.destroyallsoftware.com/talks/wat" rel="nofollow">wat video</a>, which highlights some interesting behaviour of JavaScript (JS part starts at 1:24 - 4:00).</p>
<p>I used to laugh at this and at the nonsense of it (the batman joke was gold), but wouldn’t it be good to
demystify what’s really going on and why do we have such behaviour?</p>
<h3>Adding 2 empty arrays together:</h3>
<p>The addition operator <code>+</code> will aim to either perform string concatentation OR numeric addition.</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">[] + []  // returns &quot;&quot;
</code><!-- HTML_TAG_END --></pre>
<p>The two empty arrays will try to be converted to a primitive data type, which get converted to string, which evaluates to an empty string, thus concatenating 2 empty strings, gives an empty string.</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">[] + []
// = &quot;&quot; + &quot;&quot;
// = &quot;&quot;</code><!-- HTML_TAG_END --></pre>
<h3>Adding <code>[] + {} = [object Object]</code></h3>
<p>This returns <code>[object Object]</code>. Strangely enough, we generally see this output when an object is being converted into a primitive data type into a string.</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">String(&#123;&#125;); // returns [object Object]</code><!-- HTML_TAG_END --></pre>
<p>Thus, when adding the two together:</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">[] + &#123;&#125;
// = &#39;&#39; + &#39;[object Object]&#39; // converted to string
// = &#39;[object Object]&#39;</code><!-- HTML_TAG_END --></pre>
<h3>What about <code>{} + [] = 0</code>?</h3>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">&#123;&#125; + [] // 0</code><!-- HTML_TAG_END --></pre>
<p>This one is a strange one, but JS is interpreting the front <code>{}</code> as a empty block rather than an object.
With the empty block evaluated, this means it just leaves <code>+ []</code>, which gets converted to a primitive which is a string , then a number, giving us 0</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">&#123;&#125; + []
// = + []
// = ToNumber(ToPrimitive([]))
// = ToNumber(&quot;&quot;)
// = 0</code><!-- HTML_TAG_END --></pre>
<h3><code>{} + {} = NaN</code></h3>
<p>The first <code>{}</code> is just evaluated as an empty block, and thus ignored. Which leaves us with <code>+ {}</code>. Once again, the object gets converted to a primitive, which is a string, giving us <code>+ &#39;[object Object]&#39;</code>. Next, when we try to convert this to a number, it will return <code>NaN</code>.</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">&#123;&#125; + &#123;&#125;
// = + &#123;&#125;
// = ToNumber(ToPrimitive(&#123;&#125;))
// = ToNumber(&#39;[object Object]&#39;)
// = NaN // as the string cannot be converted to number</code><!-- HTML_TAG_END --></pre>
<h3>The Batman <code>NaN</code> explanation</h3>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">Array(16).join(&quot;wat&quot; - 1);</code><!-- HTML_TAG_END --></pre>
<p>returns a string of <code>NaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaN</code>.</p>
<p>Let’s dissect the <code>&quot;wat&quot; - 1</code> part:</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">&quot;wat&quot; - 1
// = Number(&quot;wat&quot;) - 1
// = NaN - 1
// = NaN</code><!-- HTML_TAG_END --></pre>
<p>This will evaluate to NaN as trying to convert “wat” into a number will return NaN. Thus, adding numbers to NaN will still result in NaN.
The join operator will try convert this to a string, thus giving “NaN”.</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">Array(16).join(&quot;wat&quot; - 1) + &quot; Batman!&quot;
// = Array(16).join(NaN) + &quot; Batman!&quot;
// = Array(16).join(&quot;NaN&quot;) + &quot; Batman!&quot;
// = &quot;NaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaN&quot; + &quot; Batman!&quot;
// = &quot;NaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaNNaN Batman!&quot;</code><!-- HTML_TAG_END --></pre>
<p>From the spec, the + operator will try to convert left and right to a primitive (generally a string, or number), then try add the two if they conform to string or number. If both types are string, then string concatenation will occur. If both types are numbers, then numeric addition will occur.</p>
<h3>Extras</h3>
<p>Just some extra gotchas:</p>
<p><code>1 &lt; 2 &lt; 3</code> returns <code>true</code> - which is okay, but what’s really happening?</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">1 &lt; 2 &lt; 3
// = (1 &lt; 2) &lt; 3
// = true &lt; 3 // converted to boolean, then to number
// = 1 &lt; 3
// = true</code><!-- HTML_TAG_END --></pre>
<p><code>3 &gt; 2 &gt; 1</code> gives <code>false</code> following the same thinking above, even though mathematically we know this should be <code>true</code>:</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">3 &gt; 2 &gt; 1
// = (3 &gt; 2) &gt; 1
// = true &gt; 1 // boolean gets converted to number (true = 1, false = 0)
// = 1 &gt; 1
// = false</code><!-- HTML_TAG_END --></pre>
<h3>References</h3>
<ul><li><a href="https://tc39.es/ecma262/#sec-addition-operator-plus" rel="nofollow">ECMAScript spec</a></li>
<li><a href="https://medium.com/dev-proto/why-gives-object-object-object-object-in-javascript-2f350b739cc9" rel="nofollow">Chidume Nnamdi’s blog post on why <code>{} + {}</code> returns [object Object]</a></li>
<li><a href="https://stackoverflow.com/questions/9032856/what-is-the-explanation-for-these-bizarre-javascript-behaviours-mentioned-in-the" rel="nofollow">StackOverflow’s explanation on the video</a></li>
<li><a href="https://www.destroyallsoftware.com/talks/wat" rel="nofollow">Wat video</a></li>
<li>Kyle Simpson’s <a href="https://frontendmasters.com/courses/deep-javascript-v3/" rel="nofollow">Deep JavaScript Foundations</a> course on FrontEnd Masters</li></ul></div>
</article></main>


<footer class="svelte-1stbkrt"><nav class="svelte-1stbkrt"><ul><a href="/">Home</a></ul></nav>
	<p class="svelte-1stbkrt">Built with SvelteKit | 2023.</p>
</footer>


		<script type="module" data-sveltekit-hydrate="4uhwxs">
			import { start } from "../_app/immutable/start-d30e0694.js";

			start({
				env: {},
				paths: {"base":"","assets":""},
				target: document.querySelector('[data-sveltekit-hydrate="4uhwxs"]').parentNode,
				version: "1723969955669",
				hydrate: {
					node_ids: [0, 3],
					data: [null,null],
					form: null
				}
			});
		</script>
	</div>
	</body>
</html>
